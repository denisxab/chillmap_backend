(function(){"use strict";var e={9354:function(e,t,a){var o=a(9242),i=a(3396);function s(e,t,a,o,s,n){const r=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(r)}var n={},r=a(89);const l=(0,r.Z)(n,[["render",s]]);var c,d,p,m,_,u,h=l,v=a(65);a(7658);function g(e){return e.replace("@/",ENV_default_host_to_src)}function w(e){return e.replace("@/",ENV_default_host_to_backend)}async function y(e){const t=await fetch(e,{method:"GET"});return{data:await t.json(),ok:t.ok,status:t.status}}async function k(e,t){const a=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"}});return{data:await a.text(),ok:a.ok,status:a.status}}function f(e){if(Array.isArray(e))return e.map(f);if(e&&"object"===typeof e){const t={};for(const a in e)t[a]=f(e[a]);return t}return e}function b(e){let t=[];return e.what_todo_obj.forEach((e=>{t.push(e.todo)})),t}async function C(e,t){const a=await y(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${e}&lon=${t}`);if(a.ok)return a.data.display_name;console.error(`Ошибка при получении адреса по координатам: ${e} ${t}`)}(function(e){e["main_map"]="mm"})(c||(c={})),function(e){e["latitude"]="x",e["longitude"]="y",e["zoom"]="z",e["type_view"]="v",e["channel"]="c",e["mark"]="m"}(d||(d={})),function(e){e["StaticWorkSchedule"]="Постоянный график работы",e["OneTimeTemporaryEvent"]="Одноразовое временно событие",e["PeriodicPlace"]="Переодическое место"}(p||(p={})),function(e){e["UncomfortableFrequentCrowding"]="Дискомфортная частая людность",e["UncomfortableFrequentCrowdingExceptWeekends"]="Дискомфортная людность по выходным и праздникам, но в рабочие дни комфортная",e["ComfortableCrowd"]="Комфортная людность",e["Privacy"]="Уединение",e["Loneliness"]="Одиночество"}(m||(m={})),function(e){e["Monday"]="понедельник",e["Tuesday"]="вторник",e["Wednesday"]="среда",e["Thursday"]="четверг",e["Friday"]="пятница",e["Saturday"]="суббота",e["Sunday"]="воскресенье"}(_||(_={})),function(e){e["RUB"]="руб",e["USD"]="доллар",e["EUR"]="евро",e["CNY"]="юань"}(u||(u={}));const $={state(){return{geomap_json:{},settings_type_place:{},select_PropertiesMark:void 0,coordinat_click:{},select_zoom:16,type_view:c.main_map,select_channel_geomap:void 0,url_geomap:void 0}},mutations:{AUpdate_select_channel(e,t){e.select_channel_geomap=t},Update_select_zoom(e,t){e.select_zoom=t},AUpdate_coordinat_click(e,t){e.coordinat_click=t},AUpdate_type_view(e,t){e.type_view=t},Update_geomap_json(e,t){e.geomap_json=t},Update_settings_type_place(e,t){e.settings_type_place=t},AUpdate_select_PropertiesMark(e,t){e.select_PropertiesMark=t},Update_url_geomap(e,t){e.url_geomap=g(t)}},actions:{Update_coordinat_click({state:e,commit:t},{coord:a,router:o,route:i}){t("AUpdate_coordinat_click",a);let s=f(i.query);s[d.latitude]=a.latitude,s[d.longitude]=a.longitude,s[d.zoom]=e.select_zoom,s[d.type_view]=c.main_map,e.select_PropertiesMark&&(s[d.mark]=e.select_PropertiesMark.id),o.push({query:s})},Update_type_view({commit:e},{type_view:t,router:a,route:o}){e("AUpdate_type_view",t);let i=f(o.query);i[d.type_view]=t,a.push({query:i})},Update_select_channel({commit:e},{channel:t,router:a,route:o}){e("AUpdate_select_channel",t);let i=f(o.query);i[d.channel]=t,a.push({query:i})},Update_select_PropertiesMark({commit:e},{mark:t,router:a,route:o}){e("AUpdate_select_PropertiesMark",t);let i=f(o.query);i[d.mark]=t.id,a.push({query:i})}},namespaced:!0};var x=a(2483);const M={id:"main_box"},P={class:"over_box"},F={class:"up_box"},O={class:"down_box"},U={ref:"d_show_map_detail",class:"d_show_map_detail"},D={class:"map_coord_click"},z=["value"],S={class:"map_facile_div"};function Z(e,t,a,s,n,r){const l=(0,i.up)("OverBox"),c=(0,i.up)("MapContainer"),d=(0,i.up)("FacileFromMarker");return(0,i.wg)(),(0,i.iD)("div",M,[(0,i.wy)((0,i._)("div",P,[(0,i.Wm)(l,{onHidden_over_box:r.hidden_over_box,view_component:n.view_component},null,8,["onHidden_over_box","view_component"])],512),[[o.F8,n.view_component]]),(0,i._)("div",F,[(0,i.Wm)(c,{ref:"MapContainer",onOnMarkerClick:r.HandleMarkerClick,onOnEmptyMapClick:r.HandleEmptyMapClick},null,8,["onOnMarkerClick","onOnEmptyMapClick"])]),(0,i._)("div",O,[(0,i._)("div",U,[(0,i.wy)((0,i._)("input",{class:"show_map_detail",type:"image",ref:"show_map_detail",onClick:t[0]||(t[0]=(...e)=>r.ShowExtraFeaturesWindow&&r.ShowExtraFeaturesWindow(...e))},null,512),[[o.F8,n.is_show_map_detail]]),(0,i.wy)((0,i._)("input",{class:"show_map_detail",type:"image",ref:"show_map_detail_place",onClick:t[1]||(t[1]=(...e)=>r.ShowPlaceDetailsInfo&&r.ShowPlaceDetailsInfo(...e))},null,512),[[o.F8,!n.is_show_map_detail]])],512),(0,i._)("div",D,[(0,i._)("input",{type:"text",value:r.coordinat_click,id:"map_coord_click_input",placeholder:"широта,долгота",readonly:""},null,8,z)]),(0,i.wy)((0,i._)("div",S,[(0,i.Wm)(d,{ref:"map_facile"},null,512)],512),[[o.F8,n.is_show_FacileFromMarker]])])])}const H={style:{width:"100%",height:"100%"}},I={ref:"map-root",style:{width:"100%",height:"100%"}};function E(e,t,a,o,s,n){return(0,i.wg)(),(0,i.iD)("div",H,[(0,i._)("div",I,null,512)])}var j=a(7793),A=a(3725),L=a(4109),q=a(7253),B=a(9177),W=(a(1827),a(2949)),V=a(3292),T=a(9513),N=a(1508),Y=a(4693),K=a(7983),G=a(6205),R=a(2093),J=a(9966);const Q=g("@/img/default_point.png"),X=g("@/img/select.png");var ee={emits:["onMarkerClick","onEmptyMapClick"],data(){return{map:void 0,mainLayer:new L.Z({className:"mainLayer",source:new q.Z,preload:4,visible:!0}),selectLayer:new T.Z({className:"selectLayer",source:new V.Z,style:new Y.ZP({image:new G.Z({src:X,scale:(0,R.Pq)([.4,.4])})}),visible:!0}),markersLayer:new T.Z({className:"markersLayer",source:new V.Z,style:new Y.ZP({image:new G.Z({src:Q,scale:(0,R.Pq)([.3,.3])})}),visible:!0}),coordinat_click_obj_mark:void 0}},methods:{_initMap(e,t,a){this.map=new A.Z({target:this.$refs["map-root"],layers:[this.mainLayer,this.selectLayer],view:new j.ZP({zoom:t,center:(0,B.mi)([e.longitude,e.latitude]),constrainResolution:!0,projection:"EPSG:3857"})}),this.setSelectMarker(e),this.map.addLayer(this.markersLayer),this.map.on("click",this.HandleClickMap),this.map.on("pointermove",this.HandlePointermove),this.map.on("moveend",this.HandleZoom),this.updateSelectGeomap(a)},ZoomMap(){this.$store.commit("geomap/Update_select_zoom",this.$store.state.geomap.select_zoom+1)},UnZoomMap(){this.$store.commit("geomap/Update_select_zoom",this.$store.state.geomap.select_zoom-1)},setCoordinates(e,t=!1){e&&(this.view_select.setCenter((0,B.mi)([e.longitude,e.latitude])),t&&this.setSelectMarker(e))},setMarkers(e,t=void 0,{imgUrl:a,imgSize:o=[1,1],labelText:i="12:Пивная"}={}){if(e){let s=new N.Z({geometry:new W.Z((0,B.mi)([e.longitude,e.latitude]))});a&&s.setStyle(new Y.ZP({image:new G.Z({src:a,scale:(0,R.Pq)(o)}),text:new K.Z({text:i,scale:[1.3,1.3],offsetY:28,stroke:new J.Z({color:"#fff",width:3}),placement:"line"})})),t&&s.setProperties(t),this.markersLayer.getSource().addFeature(s)}},setSelectMarker(e){if(e){this.selectLayer.getSource().removeFeature(this.coordinat_click_obj_mark);var t=new N.Z(new W.Z((0,B.mi)([e.longitude,e.latitude])));this.coordinat_click_obj_mark=t,this.selectLayer.getSource().addFeature(t)}},async updateSelectGeomap(e){const t=await y(e);if(t.ok){const e=t.data;this.ClearMarkers(this.markersLayer),this.$store.commit("geomap/Update_geomap_json",e),this.ShowPlaceFromExternal(this.markersLayer,this.$store.state.geomap.geomap_json)}else console.error("Ошибка: Ответ geomap пустой")},ClearMarkers(e){e.getSource().clear()},ShowPlaceFromExternal(e,t){e.setVisible(!0);const a=t.places.settings;this.$store.commit("geomap/Update_settings_type_place",a);
//! Перебрать места и отобразить их на месте
for(let o in t.places.place)t.places.place[o].forEach((e=>{const t=a[o].img_url,i=[a[o].img_size_w,a[o].img_size_h],s={imgUrl:g(t),imgSize:i};s["labelText"]=`${e.rating%13}:${e.simpl_name.substring(0,16)}`;const n=this._parseCoordFromOpenstreetmap(`${e.cord_x},${e.cord_y}`);let r=e;r["name_marker"]=a[o].name,r["coord"]=[n.latitude,n.longitude],this.setMarkers(n,r,s)}))},_CheckIntersectionsMarker(e){let t=!1;return this.map.forEachFeatureAtPixel(e.pixel,((a,o)=>{"markersLayer"==o.getClassName()&&(this.HandleMarkerHover(e,a),t=!0)})),t},HandleClickMap(e){if(this._CheckIntersectionsMarker(e))return null;const t=(0,B.vs)(e.coordinate,"EPSG:3857","EPSG:4326").reverse();this.$store.dispatch("geomap/Update_coordinat_click",{coord:{latitude:t[0],longitude:t[1]},router:this.$router,route:this.$route}),t&&this.setSelectMarker(this._parseCoordFromOpenstreetmap(t.toString())),console.log("Нажатие по карте, в координаты: ",t),this.$emit("onEmptyMapClick",e)},HandlePointermove(e){this._CheckIntersectionsMarker(e)},HandleMarkerHover(e,t){"pointermove"==e.type&&console.debug("Наведение на маркер"),"click"==e.type&&this.HandleMarkerClick(t)},HandleMarkerClick(e){const t=e.getProperties();this.$store.dispatch("geomap/Update_select_PropertiesMark",{mark:t,router:this.$router,route:this.$route}),this.$store.dispatch("geomap/Update_coordinat_click",{coord:{latitude:t.coord[0],longitude:t.coord[1]},router:this.$router,route:this.$route}),console.log("Нажатие на маркер",t),this.$emit("onMarkerClick",t)},HandleZoom(e){this.$store.commit("geomap/Update_select_zoom",this.view_select.values_.zoom)},_parseCoordFromOpenstreetmap(e){if(""!=e){const t=e.split(",").reverse();if(2==t.length)return{longitude:parseFloat(t[0]),latitude:parseFloat(t[1])}}else console.warn("Вы не указали координаты")}},computed:{view_select(){return this.map.getView()},layers_select(){return this.map.getLayers()}}};const te=(0,r.Z)(ee,[["render",E]]);var ae=te,oe=a(7139);const ie={class:"map_facile"},se={class:"cel name_marker"},ne={class:"img"},re={ref:"img_name_marker"},le={class:"text"},ce={class:"cel simpl_name"},de={class:"img"},pe={ref:"img_simpl_name"},me={class:"text"},_e={class:"cel rating"},ue={class:"img"},he={ref:"img_rating"},ve={class:"text"},ge={class:"cel address"},we={class:"img"},ye={ref:"img_address"},ke={class:"text"},fe={class:"cel"};function be(e,t,a,o,s,n){const r=(0,i.up)("ParamsList");return(0,i.wg)(),(0,i.iD)("div",ie,[(0,i._)("div",se,[(0,i._)("div",ne,[(0,i._)("img",re,null,512)]),(0,i._)("div",le,(0,oe.zw)(s.name_marker),1)]),(0,i._)("div",ce,[(0,i._)("div",de,[(0,i._)("img",pe,null,512)]),(0,i._)("div",me,(0,oe.zw)(s.simpl_name),1)]),(0,i._)("div",_e,[(0,i._)("div",ue,[(0,i._)("img",he,null,512)]),(0,i._)("div",ve,(0,oe.zw)(s.rating),1)]),(0,i._)("div",ge,[(0,i._)("div",we,[(0,i._)("img",ye,null,512)]),(0,i._)("div",ke,(0,oe.zw)(s.address),1)]),(0,i._)("div",fe,[s.whattodo&&s.whattodo.length>0?((0,i.wg)(),(0,i.j4)(r,{key:0,params_list:s.whattodo},null,8,["params_list"])):(0,i.kq)("",!0)])])}const Ce={class:"params_list"},$e=["href"],xe={key:1};function Me(e,t,a,o,s,n){return(0,i.wg)(),(0,i.iD)("div",Ce,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.params_list,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"li_h",key:t},["string"==typeof e&&e.includes("://")?((0,i.wg)(),(0,i.iD)("a",{key:0,target:"_blank",href:e},(0,oe.zw)(e),9,$e)):((0,i.wg)(),(0,i.iD)("span",xe,(0,oe.zw)(e),1))])))),128))])}var Pe={props:{params_list:{type:Object}}};const Fe=(0,r.Z)(Pe,[["render",Me],["__scopeId","data-v-2dbec80a"]]);var Oe=Fe;const Ue=g("@/img/name_marker.svg"),De=g("@/img/simpl_name.svg"),ze=g("@/img/rating.svg"),Se=g("@/img/address.svg");var Ze={components:{ParamsList:Oe},data(){return{name_marker:void 0,simpl_name:void 0,rating:void 0,address:void 0,whattodo:void 0}},mounted(){this.$refs["img_name_marker"].src=Ue,this.$refs["img_simpl_name"].src=De,this.$refs["img_rating"].src=ze,this.$refs["img_address"].src=Se},methods:{},watch:{props_component:{async handler(e){this.name_marker=this.$store.state.geomap.settings_type_place[e.type_place].name,this.simpl_name=e.simpl_name,this.rating=e.rating,this.address=e.address,this.whattodo=b(e),this.address=await C(e.cord_x,e.cord_y)},deep:!0}},computed:{props_component(){return this.$store.state.geomap.select_PropertiesMark}}};const He=(0,r.Z)(Ze,[["render",be],["__scopeId","data-v-e525e9f4"]]);var Ie=He;const Ee=e=>((0,i.dD)("data-v-4566017d"),e=e(),(0,i.Cn)(),e),je={class:"over_box_body"},Ae=Ee((()=>(0,i._)("div",{class:"empty"},null,-1)));function Le(e,t,a,s,n,r){const l=(0,i.up)("DetailFromPlace"),c=(0,i.up)("ExtraFeaturesWindow");return(0,i.wg)(),(0,i.iD)("div",{class:"over_box_comp",onKeyup:t[1]||(t[1]=(0,o.D2)(((...e)=>r.hiddenOverBox&&r.hiddenOverBox(...e)),["esc"])),tabindex:"0"},[(0,i._)("div",je,[(0,i.wy)((0,i.Wm)(l,null,null,512),[[o.F8,"DetailFromPlace"===a.view_component]]),(0,i.wy)((0,i.Wm)(c,{onHiddenOverBox:r.hiddenOverBox},null,8,["onHiddenOverBox"]),[[o.F8,"ExtraFeaturesWindow"===a.view_component]])]),Ae,(0,i._)("input",{ref:"hidden_over_box",class:"hidden_over_box",type:"image",onClick:t[0]||(t[0]=(...e)=>r.hiddenOverBox&&r.hiddenOverBox(...e))},null,512)],32)}const qe={class:"box"},Be={class:"title"},We={key:0,class:"name"},Ve={class:"value"},Te={key:0,class:"list"},Ne=["href"],Ye={key:2};function Ke(e,t,a,o,s,n){const r=(0,i.up)("ParamsList");return(0,i.wg)(),(0,i.iD)("div",qe,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.view_list,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"row",key:t},[(0,i._)("div",Be,(0,oe.zw)(e.title),1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.data,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"view_list_data",key:t},[e.name?((0,i.wg)(),(0,i.iD)("div",We,(0,oe.zw)(e.name),1)):(0,i.kq)("",!0),(0,i._)("div",Ve,["object"==typeof e.value?((0,i.wg)(),(0,i.iD)("div",Te,[(0,i.Wm)(r,{params_list:e.value},null,8,["params_list"])])):"string"==typeof e.value&&e.value.includes("://")?((0,i.wg)(),(0,i.iD)("a",{key:1,target:"_blank",href:e.value},(0,oe.zw)(e.value),9,Ne)):((0,i.wg)(),(0,i.iD)("span",Ye,(0,oe.zw)(e.value),1))])])))),128))])))),128))])}function Ge(){return{phones:void 0,website:void 0,tg:void 0,vk:void 0,any_social:void 0,yandex_map:void 0,any_link:void 0}}var Re={components:{ParamsList:Oe},data(){return{name_marker:void 0,rating:void 0,simpl_name:void 0,whattodo:void 0,address:void 0,AveragePopulation:void 0,AverageCostVisit:void 0,FavoritesCountMore:void 0,"InternetСontacts":Ge()}},methods:{async updateData(e){this.clear_ppd()},parse_ppd(e){this.AveragePopulation=m[e.AveragePopulation],this.AverageCostVisit=`${e.AverageCostVisit.value} ${u[e.AverageCostVisit.currency]}`,this.InternetСontacts=e.InternetСontacts,this.FavoritesCountMore=`более ${e.FavoritesCountMore}`},clear_ppd(){this.AveragePopulation=void 0,this.AverageCostVisit=void 0,this.InternetСontacts=Ge(),this.FavoritesCountMore=void 0}},watch:{props_component:{handler(e){this.name_marker=this.$store.state.geomap.settings_type_place[e.type_place].name,this.rating=e.rating,this.simpl_name=e.simpl_name,this.address=e.address,this.whattodo=b(e),this.updateData(e)},deep:!0}},computed:{props_component(){return this.$store.state.geomap.select_PropertiesMark},view_list(){return[{title:"Общая информация",data:[{name:"Тип маркера",value:this.name_marker},{name:"Рейтинг",value:this.rating},{name:"Название",value:this.simpl_name},{name:"Адрес",value:this.address},{name:"Средняя людность",value:this.AveragePopulation},{name:"Средняя стоимость посещения",value:this.AverageCostVisit},{name:"В избранных",value:this.FavoritesCountMore}]},{title:"Чем тут можно заняться",data:[{value:this.whattodo}]},{title:"Это место в интернете",data:[{name:"phones",value:this.InternetСontacts.phones},{name:"website",value:this.InternetСontacts.website},{name:"tg",value:this.InternetСontacts.tg},{name:"vk",value:this.InternetСontacts.vk},{name:"any_social",value:this.InternetСontacts.any_social},{name:"yandex_map",value:this.InternetСontacts.yandex_map},{name:"any_link",value:this.InternetСontacts.any_link}]}]}}};const Je=(0,r.Z)(Re,[["render",Ke],["__scopeId","data-v-6585933a"]]);var Qe=Je;const Xe={class:"container"},et={class:"box_extra"},tt={class:"box_select_elm"};function at(e,t,a,s,n,r){const l=(0,i.up)("AddPlace");return(0,i.wg)(),(0,i.iD)("div",Xe,[(0,i.wy)((0,i._)("div",et,[(0,i._)("div",{class:"row",onClick:t[0]||(t[0]=e=>r.handleClick("add_place"))}," Создать новое место в выбранной точки "),(0,i._)("div",{class:"row",onClick:t[1]||(t[1]=(...e)=>r.channel_list&&r.channel_list(...e))}," Список каналов "),(0,i._)("div",{class:"row",onClick:t[2]||(t[2]=e=>r.handleClick("login"))},"Вход"),(0,i._)("div",{class:"row",onClick:t[3]||(t[3]=e=>r.handleClick("registration"))}," Регистрация "),(0,i._)("div",{class:"row",onClick:t[4]||(t[4]=e=>r.handleClick("about"))},"О проекте")],512),[[o.F8,void 0==n.select_elm]]),(0,i._)("div",tt,[(0,i.wy)((0,i.Wm)(l,{ref:"add_place",onHidden_elm:r.hidden_elm,onHiddenOverBox:r.hiddenOverBox},null,8,["onHidden_elm","onHiddenOverBox"]),[[o.F8,"add_place"===n.select_elm]])])])}const ot=e=>((0,i.dD)("data-v-9bd0040a"),e=e(),(0,i.Cn)(),e),it={class:"box_extra"},st={class:"row"},nt=ot((()=>(0,i._)("div",{class:"label"},"* Короткое имя:",-1))),rt={class:"row"},lt=ot((()=>(0,i._)("div",{class:"label"},"* Рейтинг места:",-1))),ct={class:"row"},dt=ot((()=>(0,i._)("div",{class:"label"},"* What to do:",-1))),pt=["value"],mt={class:"row"},_t=ot((()=>(0,i._)("div",{class:"label"},"* Type place:",-1))),ut=["value"];function ht(e,t,a,s,n,r){return(0,i.wg)(),(0,i.iD)("div",it,[(0,i._)("label",st,[nt,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.shortName=e)},null,512),[[o.nr,n.shortName]])]),(0,i._)("label",rt,[lt,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.rating=e),type:"number",min:"0",max:"5"},null,512),[[o.nr,n.rating]])]),(0,i._)("label",ct,[dt,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.todo=e),multiple:"",class:"todo"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.todoOptions,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e},(0,oe.zw)(e.todo),9,pt)))),256))],512),[[o.bM,n.todo]])]),(0,i._)("label",mt,[_t,(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.typePlace=e)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.typePlaceOptions,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e},(0,oe.zw)(e.name),9,ut)))),256))],512),[[o.bM,n.typePlace]])]),(0,i._)("input",{class:"send_bt",type:"button",value:"Отправить",onClick:t[4]||(t[4]=(...e)=>r.create_geomap&&r.create_geomap(...e))}),(0,i._)("input",{ref:"hidden_elm",class:"hidden_elm",type:"image",onClick:t[5]||(t[5]=(...e)=>r.hidden_elm&&r.hidden_elm(...e))},null,512)])}var vt={emits:["hidden_elm","hiddenOverBox"],mounted(){this.$refs["hidden_elm"].src=xt,this.show()},data(){return{shortName:"",rating:0,todo:[],typePlace:{},todoOptions:[],typePlaceOptions:[]}},methods:{hidden_elm(){this.$emit("hidden_elm")},async create_geomap(){console.log("Отправка: создание нового места");const e=this.$store.state.geomap.coordinat_click,t={cord_x:e.latitude,cord_y:e.longitude,simpl_name:this.shortName,rating:this.rating,address:"",channel_geomap:this.$store.state.geomap.select_channel_geomap.id,what_todo:this.todo.map((e=>e.id)),type_place:this.typePlace.id},a=await k(Ut,t);a.ok?(alert("Успешное создание нового места"),this.hidden_elm(),this.$emit("hiddenOverBox")):alert("Ошибка создания нового места")},async show(){const[e,t]=await Promise.all([y(Ft),y(Ot)]);e.ok&&(this.todoOptions=e.data),t.ok&&(this.typePlaceOptions=t.data),this.typePlace=this.typePlaceOptions[0]}}};const gt=(0,r.Z)(vt,[["render",ht],["__scopeId","data-v-9bd0040a"]]);var wt=gt,yt={components:{AddPlace:wt},data(){return{select_elm:void 0}},methods:{async handleClick(e){await this.$refs[e].show(),this.select_elm=e},channel_list(){this.$router.push({name:"list_channels"})},hidden_elm(){this.select_elm=void 0},hiddenOverBox(){this.$emit("hiddenOverBox")}}};const kt=(0,r.Z)(yt,[["render",at],["__scopeId","data-v-0a0b0e6a"]]);var ft=kt,bt={emits:["hidden_over_box"],components:{DetailFromPlace:Qe,ExtraFeaturesWindow:ft},props:{view_component:{type:Object}},mounted(){this.$refs["hidden_over_box"].src=xt},methods:{hiddenOverBox(){this.$emit("hidden_over_box")}}};const Ct=(0,r.Z)(bt,[["render",Le],["__scopeId","data-v-4566017d"]]);var $t=Ct;const xt=g("@/img/arrow_up.svg"),Mt=g("@/img/info_from_place.svg"),Pt=w("@/api/v1/channel_geomap_place/"),Ft=w("@/api/v1/what_todo/"),Ot=w("@/api/v1/type_place/"),Ut=w("@/api/v1/place/"),Dt=w("@/api/v1/channel_geomap/");var zt={name:"MapApp",components:{MapContainer:ae,FacileFromMarker:Ie,OverBox:$t},data(){return{view_component:void 0,is_show_FacileFromMarker:!1,is_show_map_detail:!0}},async mounted(){this.$refs["show_map_detail"].src=xt,this.$refs["show_map_detail_place"].src=Mt,await this.Mounted_ParseUrl(),this.$store.commit("geomap/Update_url_geomap",g(Pt)+this.$store.state.geomap.select_channel_geomap.id),this.$refs["MapContainer"]._initMap(this.$store.state.geomap.coordinat_click,this.$store.state.geomap.select_zoom,this.$store.state.geomap.url_geomap)},computed:{coordinat_click(){const e=this.$store.state.geomap.coordinat_click;return e?[e.latitude,e.longitude]:[]}},methods:{setCoordinates(e,t=!1){this.$refs["MapContainer"].setCoordinates(this.$refs["MapContainer"]._parseCoordFromOpenstreetmap(e),t)},HandleMarkerClick(e){this.ShowPlaceFacileInfo()},HandleEmptyMapClick(e){this.is_show_map_detail=!0,this.is_show_FacileFromMarker=!1},ShowPlaceFacileInfo(){this.is_show_map_detail=!1,this.is_show_FacileFromMarker=!0},ShowPlaceDetailsInfo(){this.view_component="DetailFromPlace"},ShowExtraFeaturesWindow(){this.view_component="ExtraFeaturesWindow"},hidden_over_box(){this.view_component=void 0},async Mounted_ParseUrl(){let e=f(this.$route.query);const t=parseInt(e["c"]);if(!t)return console.log("Не указан ID канала"),void this.$router.push({name:"list_channels"});{const e=await y(Dt+t);if(e.ok){const t=e.data;this.$store.dispatch("geomap/Update_select_channel",{channel:t,router:this.$router,route:this.$route})}else console.error("Не удалось получить список каналов")}let a=parseInt(e["z"]);a||(a=16),this.$store.commit("geomap/Update_select_zoom",a),this.$store.dispatch("geomap/Update_coordinat_click",{coord:e[d.latitude]&&e[d.longitude]?{latitude:e[d.latitude],longitude:e[d.longitude]}:{latitude:this.$store.state.geomap.select_channel_geomap.default_coord_x,longitude:this.$store.state.geomap.select_channel_geomap.default_coord_y},router:this.$router,route:this.$route}),this.$store.dispatch("geomap/Update_type_view",{type_view:e[d.type_view]?e[d.type_view]:c.main_map,router:this.$router,route:this.$route}),this.$router.push({query:e})}}};const St=(0,r.Z)(zt,[["render",Z]]);var Zt=St;const Ht=e=>((0,i.dD)("data-v-3cd9904a"),e=e(),(0,i.Cn)(),e),It={class:"channel-list"},Et=Ht((()=>(0,i._)("h1",null,"Список каналов",-1))),jt=["onClick"];function At(e,t,a,o,s,n){return(0,i.wg)(),(0,i.iD)("div",It,[Et,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.channels,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id},[(0,i._)("button",{class:"channel-button",onClick:t=>n.selectChannel(e)},(0,oe.zw)(e.name),9,jt)])))),128))])}var Lt={data(){return{channels:[]}},async mounted(){await this.fetchChannels()},methods:{async fetchChannels(){const e=await y(Dt);e.ok?this.channels=e.data:console.error("Не удалось получить список каналов")},selectChannel(e){this.$store.dispatch("geomap/Update_select_channel",{channel:e,router:this.$router,route:this.$route});d.channel;this.$router.push({name:"main_map",query:{c:e.id}})}}};const qt=(0,r.Z)(Lt,[["render",At],["__scopeId","data-v-3cd9904a"]]);var Bt=qt;const Wt=[{path:"/",name:"main_map",component:Zt},{path:"/channels",name:"list_channels",component:Bt}],Vt=(0,x.p7)({routes:Wt,history:(0,x.PO)()});var Tt=(0,v.MT)({state:{},getters:{},mutations:{},actions:{},modules:{geomap:$}});let Nt=(0,o.ri)(h);Nt.use(Vt).use(Tt).mount("#app")}},t={};function a(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,o,i,s){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],s=e[d][2];for(var r=!0,l=0;l<o.length;l++)(!1&s||n>=s)&&Object.keys(a.O).every((function(e){return a.O[e](o[l])}))?o.splice(l--,1):(r=!1,s<n&&(n=s));if(r){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,i,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,s,n=o[0],r=o[1],l=o[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var d=l(a)}for(t&&t(o);c<n.length;c++)s=n[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},o=self["webpackChunkweb_chillmap"]=self["webpackChunkweb_chillmap"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(9354)}));o=a.O(o)})();
//# sourceMappingURL=app.58d08806.js.map