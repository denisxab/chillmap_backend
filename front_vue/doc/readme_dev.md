Пол postgres
Пар denis
БД testing_xab2

Название Проекта = smapms

# TODO

1. Делаем процедуры для чтения данных
2. Подымаем FastApi сервер который будет использовать эти процедуры.
3. Раздаем статику через python -m http.server (если будет время то и про nginx  подумать)

# Инфраструктура

1. Переносим шаблонны данных в PostgresSQL. Продумаываем схемы таблиц, и процедуры добавления и изменения данных, узнать возможность у PostgreSQL вызвать http метод, для уведомления Redis об изменениях
   1. Продумать систему шардировани деапазонов, создать таблицу удаленных id, чтобы впервую очерь брать из него id
2. Создать Виртульку на жестком диске, поместить в докер PostgreSQL, сделать все настройки для работы PostgreSQL в контейнере.

--------------

- R1
  - Описание: Первый уровень в который обращаются клиент для чтения данных.
  - Что делает: Должен распределить запрос, по шардам

Например запрос

```json
{

}
```

- Шардирвоание БД
  - Шард - Диапазон идентификаторов группы - [[0,1000],[1001,2000],[2001,3000]]. Чтобы диапазоны заполнялись полностью без пустот(например группа удалилась и id освободился) нужно создать таблицу для удаленных группы, и для новых групп брать id в первую очередь из этой таблицы. Каждый шард храниться в отдельной БД, и вся информация о группе которая попала в этот шард также храниться в этой БД. Такой вариант позволяет горизонтально раст в объеме хранения данных.

- Шардирование Redis
  - Шард - условное разделение диапазонов группы на количество подключенных редисов. Например если два редиса обращаются к одному шарду БД с диапазоном [1001,2000], то тогда шарды редисов будут(`(2000-1001)/2`) = Для первого [1001,1500] для второго [1501,2000]. Если один редис подключается к одной БД то тогда диапазон такой же [1001,2000].

- ? где храниься таблица шардирования, и на каком этапе должно происходить разделение

Шардирование должно быть на уровне R1, тоесть уже перед запросом в Redis.

# План действий

1. Создать виртуалку на диске, и потетсить докер с Nginx(Нужно узнать может ли nginx маршрутизировать по значению заголовка(идентификатор группы), чтобы можно было выполнять шардирование)

1. Сделать документацию по OpenLayers.

## План для Фронта

0. Добавить VUEX и хранилище для `geom_whattodo_det`, да и остальное тоже лучше переделать на хранилище(поверхностное описание, подробное описание, список групп)

-. + Указывать текущие координаты в url
-. + Рейтинг о месте, в 12 бальной шкале.
-. + Продумать как хранить пути к изображениям, особенно в файлах со внешними координатами
4. Поверхностная(+) и Детальная информация о месте.
5. Фильтрация маркеров по их имени группы. И по городу в котором идет поиск, например все места в СПБ в радиусе 200км от центра. Также отображать этот радиус на карте
6. Добавление новых и изменение информации существующих - интересных мест
7. Продумать как пользователи смогут хранить свои любимые интересные места. Как они будут регистрироваться и авторизоваться.

## План для DEV OPS

- Добавить в `.bash_remote` путь для `id_rsa` при подключение по `ssh`, а также в команде `-ssh-cf` использовать этот путь к `id_rsa` для подключения.
- Сделать в  `bashlere` возможность автоматически изменить конфигурации `sshd_conf` - запрещать авторизацию по паролю, при копирование ключа.
- Прочитать и задокументировать `screen` <https://blackdiver.net/it/linux/4164>.
- Прочитать про фаервол, как можно заблокировать все соединения к серверу кроме `22,23,8000,8080` порта ?

# Полезные ссылки

- Интеграция карты OpenLayers в Vue.js, пошаговое руководство - <https://dev.to/camptocamp-geo/integrating-an-openlayers-map-in-vue-js-a-step-by-step-guide-2n1p>

- Api openlayers - <https://openlayers.org/en/latest/apidoc/module-ol_View-View.html#setCenter>

# VUE Openlayers

- Установка

```bash
npm install --save ol
```

# Openlayers

## Map

Создать объект для хранения слоев карту

```js
let M_A_P = new OpenLayers.Map("IdHtmlТегаВкторыйВставитсьяКарта");
```

## Layer

Создать и добавить слой

```js
M_A_P.addLayer(new OpenLayers.Layer.OSM());
```

## Курсор карты

Установить курсор кары в указанное положение

```js
// Число приближение, чем больше тем ближе
let zoom=16 
//  СОздать курсор для указанных координат
let lonLat = new OpenLayers.LonLat(ДОЛГОТА, ШИРОТА)
    .transform(
        new OpenLayers.Projection("EPSG:4326"), 
        map.getProjectionObject() 
    );
// Установить курсор карты в указанное положение
M_A_P.setCenter(lonLat, zoom);
```

## Маркеры на карте

Создать маркер на карте

```js
// Создать маркер
let markers = new OpenLayers.Layer.Markers("Markers");
// Добавить маркер на слой
markers.addMarker(new OpenLayers.Marker(lonLat));
// Удалить маркер со слоя
markers.removeMarker(def_pos_marker)
```
